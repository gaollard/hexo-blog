## 1、dig 介绍

dig 是一种用于查询域名系统（DNS）服务器的命令行工具。默认情况下，dig 确实使用本地主机的 DNS 解析器来执行查询。但是，在某些情况下，dig 可能会绕过本地主机的 DNS 解析器，例如：

1. 指定了其他 DNS 服务器：如果您在使用 dig 时显式指定了其他 DNS 服务器，则 dig 会直接与该 DNS 服务器进行通信而不会使用本地主机的 DNS 解析器。

2. 主机配置错误：如果您的主机的 DNS 配置不正确，则 dig 可能无法正确解析域名。例如，如果主机的 DNS 配置未正确设置，或者您的 DNS 服务器停止工作，则 dig 将无法使用本地主机的 DNS 解析器并返回错误。

3. 缓存问题：如果 dig 在其缓存中具有与您查询的域名相同的信息，则它将返回其缓存中的数据而不会使用本地主机的 DNS 解析器。这可能会导致 dig 绕过本地主机的 DNS 解析器而返回意外的结果。

## 2、dig 输出解释

在使用 dig 命令时，您可以得到以下各种输出。下面是常见的 dig 输出及其含义：

1. 查询结果信息

   - ;; QUESTION SECTION: 提问区域 - 显示您要查询的域名。
   - ;; ANSWER SECTION: 回答区域 - 显示来自 DNS 服务器的回答，包括 IP 地址和其他资源记录。
   - ;; AUTHORITY SECTION: 权威区域 - 显示来自授权 DNS 服务器的信息，用于该域的名称服务器。
   - ;; ADDITIONAL SECTION: 附加区域 - 显示其他信息，例如 DNS 服务器的 IPv6 地址等。

2. 域名服务器信息

   - ;; SERVER: 服务器地址 - 显示 DNS 服务器的 IP 地址或名称。
   - ;; WHEN: 时间戳 - 显示查询时间戳。

3. 查询状态信息
   - ;; Query time: 时间 - 显示查询时间，通常以毫秒为单位。
   - ;; MSG SIZE rcvd: 大小 - 显示接收到的消息大小，以字节为单位。

其他可能的输出包括警告和错误信息，如格式错误等。您可以使用 dig 的不同选项来控制和更改输出内容的详细程度。

## 3、使用 dig 显示 dns 寻址过程

https://www.cnblogs.com/chanshuyi/p/dns_dig_command.html

## 4、dig 结果 和 /etc/hosts 有关吗

是的，dig命令的结果可以与/etc/hosts文件有关。/etc/hosts文件是Linux系统中的本地主机名解析器，它包含IP地址与主机名之间的映射关系，可以用于绕过DNS服务器直接解析主机名。
当您使用dig命令查询域名时，dig查询先查看本地hosts文件是否已经存在该域名的解析信息。如果hosts文件中包含了该域名的IP地址对应关系，则dig优先使用该信息完成查询，而不会继续向DNS服务器发送查询请求。因此，如果您的/etc/hosts文件中存在与要查询的域名有关的条目，则dig输出结果中的IP地址可能会与您在该文件中定义的地址相匹配。

需要注意的是，如果您在查询时指定了使用某个DNS服务器进行查询，则dig不会使用本地主机名解析器查找/etc/hosts文件中的主机名和IP地址映射关系，而是直接查询指定的DNS服务器。
